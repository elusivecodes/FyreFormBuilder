<?php
declare(strict_types=1);

namespace Tests;

use
    Fyre\FormBuilder\FormBuilder,
    Fyre\HTMLHelper\HtmlHelper;

trait OpenTest
{

    public function testOpen(): void
    {
        $this->assertSame(
            '<form method="post" charset="UTF-8">',
            FormBuilder::open()
        );
    }

    public function testOpenAction(): void
    {
        $this->assertSame(
            '<form action="/test" method="post" charset="UTF-8">',
            FormBuilder::open('/test')
        );
    }

    public function testOpenCharset(): void
    {
        HtmlHelper::setCharset('ISO-8859-1');

        $this->assertSame(
            '<form method="post" charset="ISO-8859-1">',
            FormBuilder::open()
        );
    }

    public function testOpenAttributes(): void
    {
        $this->assertSame(
            '<form class="test" id="form" method="post" charset="UTF-8">',
            FormBuilder::open(null, [
                'class' => 'test',
                'id' => 'form'
            ])
        );
    }

    public function testOpenAttributesOrder(): void
    {
        $this->assertSame(
            '<form class="test" id="form" method="post" charset="UTF-8">',
            FormBuilder::open(null, [
                'id' => 'form',
                'class' => 'test'
            ])
        );
    }

    public function testOpenAttributeInvalid(): void
    {
        $this->assertSame(
            '<form class="test" method="post" charset="UTF-8">',
            FormBuilder::open(null, [
                '*class*' => 'test'
            ])
        );
    }

    public function testOpenAttributeEscape(): void
    {
        $this->assertSame(
            '<form data-test="&lt;test&gt;" method="post" charset="UTF-8">',
            FormBuilder::open(null, [
                'data-test' => '<test>'
            ])
        );
    }

    public function testOpenAttributeArray(): void
    {
        $this->assertSame(
            '<form data-test="[1,2]" method="post" charset="UTF-8">',
            FormBuilder::open(null, [
                'data-test' => [1, 2]
            ])
        );
    }

}
